---
- name: Directories
  hosts: all
  tasks:
    - action: file
      name: Create
      args:
        path: "{{item}}"
        state: directory
      with_items:
        - ~/bin
        - ~/.config
    - action: file
      name: Delete
      args:
        path: "{{item}}"
        state: absent
      with_items:
        - ~/Music
        - ~/Public
        - ~/Templates
        - ~/Videos
        - ~/examples.desktop
- name: Install packages
  hosts: all
  sudo: yes
  tasks:
    - action: apt
      name: Install lsb-core
      args:
        name: lsb-core
    - shell: lsb_release -a | grep Codename | cut -f 2
      register: ubuntu_codename
    - action: apt_key
      name: Add apt keys
      args:
        keyserver: hkp://keyserver.ubuntu.com:80
        id: 94558F59
    # - name: Add ubuntu universe
    #   action: apt_repository
    #   args:
    #     repo: "deb http://archive.ubuntu.com/ubuntu {{ubuntu_codename.stdout}} main universe restricted multiverse"
    - action: apt
      args:
        update_cache: yes
    - action: apt
      name: Install packages
      args:
        name: "{{item}}"
      with_items:
        - aptitude
        - build-essential
        - curl
        - git
        - gnupg
        - gzip
        - mono-complete
        - nautilus-dropbox
        - network-manager
        - network-manager-openvpn
        - python-dev
        - python-software-properties # apt-add-repostory
        - rng-tools
        - ruby
        - tar
        - tree

        # Emacs
        - emacs24
        - emacs24-el
        - emacs-goodies-el

        # erlang/otp
        - autoconf
        - libncurses5-dev
        - libssl-dev
        # erlang wx support
        - libwxgtk2.8-dev
        - freeglut3-dev
    - shell: git config --global user.email "tjarvstrand@gmail.com"
      sudo: no
    - shell: git config --global user.name "Thomas JÃ¤rvstrand"
      sudo: no
    - shell: localectl set-keymap dvorak
    - action: lineinfile
      args:
        regexp: "[# ]*keycode 58 ="
        line: "keycode 58 = Control"
        dest: /etc/console-setup/remap.inc
    - shell: dpkg-reconfigure -f noninteractive keyboard-configuration